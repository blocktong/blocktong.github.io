{"pageProps":{"post":{"title":"세마포어를 활용한 은행설명서 포인트에 대해 자세히 알아보기","description":"","date":"2024-05-18 00:41","slug":"2024-05-18-ADeepDiveintoSemaphore-PoweredPrivatePayments","content":"\n\n![Screenshot](/assets/img/2024-05-18-ADeepDiveintoSemaphore-PoweredPrivatePayments_0.png)\n\n## Prerequisites:\n\nTo get the most out of this article, it's essential to have a good understanding of Semaphore. You can find the documentation [here](https://docs.semaphore.pse.dev/).\n\n# Introduction \n\n<div class=\"content-ad\"></div>\n\n암호화폐 세계에서는 개인 정보 보호가 매우 중요합니다. 블록체인 기술은 투명성을 제공하지만 종종 민감한 금융 정보를 노출시킬 수 있습니다. 이에 Tornado Cash와 같은 해결책이 등장했는데, 이러한 해결책은 거래에서 익명성을 제공하려는 목표를 가지고 있습니다. 그러나 Tornado Cash는 남용 가능성으로 인해 조명을 받았습니다.\n\n여기에 강력한 프로토콜인 Semaphore이 등장했습니다. Semaphore은 거래 세부 정보를 숨기기 위해 제로-지식 증명 (ZKP)을 활용합니다. 이는 높은 수준의 제어와 사용자 정의 기능을 제공하여 개인 정보 보호 애플리케이션을 구축하는 데 이상적입니다.\n\n이 기사에서는 Semaphore의 새로운 응용 프로그램인 Paybox를 탐색할 것입니다. 이 분산 시스템은 자금을 안전하고 비공개적으로 관리하기 위해 Semaphore 프로토콜의 힘을 활용합니다.\n\n## Paybox\n\n<div class=\"content-ad\"></div>\n\nPaybox는 사용자가 자신의 기금을 예금할 수 있는 개인 “paybox”를 만들 수 있도록 합니다.\n\n다음은 작동 방식입니다:\n\n- Paybox 생성: Paybox를 생성하여 상자의 “소유자”가 됩니다.\n- 자금 예금: 그 후 다른 사람들은 당신의 Paybox로 돈을 송금할 수 있습니다. 그들은 당신의 개인 정보를 알 필요가 없으며 Paybox ID만 필요합니다.\n- 자금 액세스: 소유자로서 원할 때마다 당신의 Paybox의 돈을 인출할 수 있습니다.\n\n이것을 디지턈 기부 상자처럼 생각해보세요:\n\n<div class=\"content-ad\"></div>\n\n- 특정 페이박스로 돈을 보내는 방식으로 사람들은 목적에 기부할 수 있습니다.\n- 목적을 시작한 사람(페이박스 소유자)은 그 후에 rekte된 자금을 인출할 수 있습니다.\n\n페이박스는 가장 간단한 형태로 익명 및 안전하게 돈을 모으는 방법이며 전통적인 은행 계좌나 결제 처리기가 필요하지 않습니다.\n\n## 페이박스를 위한 세마포어 사용법\n\n세마포어 프로토콜은 제로-지식-증명(ZKP)을 페이박스 프로젝트에 도입하는 혁신적인 방법입니다. 세마포어는 우리의 주요 페이박스 계약 내에서 많은 머클 트리를 빠르고 쉽게 만들 수 있는 자원을 제공합니다. 각각의 머클 트리는 사용자가 예금하길 원하는 다른 금액에 대해 사용될 것입니다.\n\n<div class=\"content-ad\"></div>\n\n# 스마트 계약\n\n우리는 생성자에서 이미 1~100까지의 그룹을 만들 것입니다. 이러한 그룹들은 자신의 paybox로 자금을 입금하는 과정에서 믹서로 사용될 것입니다. _createGroup 함수는 그룹 ID와 관리자를 입력받습니다. 믹서 그룹의 경우 누구도 관리자가 되면 안 되기 때문에 스마트 계약 자체가 그 역할을 수행할 것입니다.\n\n```js\nconstructor(ISemaphoreVerifier _verifier) Semaphore(_verifier) {\n      for (uint i=1; i<=100; i++) {\n          _createGroup(i, address(this));\n      }\n  }\n```\n\n## 상자 열기\n\n<div class=\"content-ad\"></div>\n\n상자를 열려면 상자 매핑에서 현재 그룹 ID와 함께 메시지 보내는 사람을 소유자로 설정합니다. 이 변수는 101부터 시작하여 새 상자마다 증가합니다.\n\n```js\nuint currentGroupId = 101;    \nfunction createBox() public {\n      boxes[currentGroupId].owner = msg.sender;\n      currentGroupId++;\n  }\n```\n\n## 입금\n\n상자에 자금을 입금하려면 세마포어 ID를 생성해야 합니다. 이 ID에는 후에 증명을 생성하는 데 사용할 커밋먼트와 시크릿, 널리파이어가 포함됩니다. Identity를 생성하기 위해 Semaphore에는 매우 쉽게 사용할 수있는 JS 패키지가 있습니다.\n\n<div class=\"content-ad\"></div>\n\n```javascript\nconst { Identity } = require(\"@semaphore-protocol/identity\")\nconst identity = new Identity()\nconsole.log(identity)\n```\n\n이 신원 정보에는 후에 사용할 개인 키도 함께 포함되어 있습니다. 현재는 단순히 커밋먼트만 필요합니다.\n\n커밋먼트와 함께 자금을 예금할 때 사용자는 삽입할 금액을 입력해야 합니다. 이 금액은 사용자의 커밋먼트가 100개 그룹 중 어느 그룹에 배치될지 결정하는 데 사용됩니다.\n\n```javascript\nfunction deposit(uint amount, uint256 commitment) public payable {\n    require(1 <= amount && amount <= 100, \"Amount is not valid\");\n    require(amount <= msg.value - 1);\n    this.addMember(amount, commitment);\n}\n```\n\n<div class=\"content-ad\"></div>\n\n## 상자에 자금 추가하기\n\n이제 사용자가 특정 금액에 해당하는 그룹 내의 약속을 가지고 있으므로 addAmountToBox 함수를 호출할 수 있습니다. 이 호출은 유효한 증명만 있으면 어떤 지갑에서든 수행할 수 있습니다. 이 단계에서 사용자는 상자와 구분됩니다.\n\n사용자는 자신의 식별정보로 생성된 증명, 약속이 있는 그룹의 groupId(금액에 해당) 및 자금을 제공하려는 상자의 boxId와 함께 이 함수를 호출할 것입니다. 증명이 유효성 검사를 통과하면 nullifierHash가 그룹에 저장되고 groupId(금액)이 boxId의 boxFund에 추가됩니다.\n\n```js\nfunction addAmountToBox(SemaphoreProof calldata proof, uint groupId, uint boxId)public {\n    require(scope == proof.scope, \"유효 범위가 맞지 않음\");\n    if (groups[groupId].nullifiers[proof.nullifier]) {\n        revert Semaphore__YouAreUsingTheSameNullifierTwice();\n    }\n    // 증명이 성공적으로 검증되지 않으면 함수가 되돌아갑니다.\n    if (!verifyProof(groupId, proof)) {\n        revert Semaphore__InvalidProof();\n    }\n    groups[groupId].nullifiers[proof.nullifier] = true;\n    boxes[boxId].boxFund += groupId;\n}\n```\n\n<div class=\"content-ad\"></div>\n\n프로프를 생성하고 인출 함수를 호출하려면 Semaphore 패키지를 사용할 수 있습니다.\n\n```js\nconst {SemaphoreEthers} = require(\"@semaphore-protocol/data\")\nconst { Group } =require (\"@semaphore-protocol/group\")\nconst { generateProof, verifyProof} =require (\"@semaphore-protocol/proof\")\n\nconst semaphoreEthers = new SemaphoreEthers(\"http://3.22.38.202:8545\", {\n    address: \"0xf7C339C5520f6800266227878A6A44Db4eEc35C4\"\n})\nfunction main(){\n  const payboxContract = new ethers.Contract(\"0xf7C339C5520f6800266227878A6A44Db4eEc35C4\", payboxTCAbi, wallet)\n  const identity = new Identity(\"e6d8b796a4d35d6b7c3461048ec2e7a0f9d48a61d9d19063f95bcbf384d21330\")\n  const members = await semaphoreEthers.getGroupMembers(\"75\")\n  const group = new Group(members)\n  const proof = await generateProof(identity, group, 0, publicNullifier)\n  const tx = await payboxContract.addAmountToBox(proof, 75, 102)\n  console.log(\"자금을 인출 중입니다...\")\n  await tx.wait()\n}\n```\n\n## 출금\n\n출금 함수는 매우 간단합니다. 상자 ID 소유자에 해당하는 지갑은 출금하려는 금액과 함께 함수를 호출해야 합니다. 이 금액은 그런 다음 계약으로부터 지갑으로 이체되며 상자 자금은 재설정됩니다.\n\n<div class=\"content-ad\"></div>\n\n```js\nfunction withdraw(uint boxId, uint amountToWithdraw)public{\n    require(boxes[boxId].owner == msg.sender, \"ur not the owner of the box\");\n    uint amount;\n    if(amountToWithdraw > boxes[boxId].boxFund){    // if amount req is bigger than fund give everything in box\n        payable(msg.sender).transfer(boxes[boxId].boxFund);\n        boxes[boxId].boxFund = 0;\n    }\n    else{   // if amount is smaller than fund give amount\n        payable(msg.sender).transfer(amount);\n        boxes[boxId].boxFund -= amount;\n    }\n}\n```\n\n# 결론\n\n세마포어 프로토콜을 기반으로 한 Paybox 시스템은 암호화폐 분야에서 더 안전하고 비공개적인 거래를 위한 중요한 발전을 나타냅니다. 토네이도 캐시의 익명성 원칙을 Semaphore의 향상된 제어 및 사용자 정의 기능과 결합하여 자금을 관리하기 위한 독특하고 강력한 시스템을 만들었습니다.\n\n주요 포인트:\n\n<div class=\"content-ad\"></div>\n\n- Paybox은 결제 시 개인 정보 보호와 보안을 위해 Semaphore 프로토콜을 활용하고 있습니다.\n- 개별 Paybox를 나타내기 위해 Semaphore 그룹을 사용합니다.\n- 사용자는 익명으로 자금을 입금할 수 있으며, Paybox 관리자는 언제든지 인출할 수 있습니다.\n- 이 시스템은 강화된 개인 정보 보호와 안전을 제공하면서 자금을 유연하고 강력하게 관리할 수 있는 방법을 제시합니다.\n- Paybox 계약은 암호화폐나 ERC20과 함께 사용되며, 달러와 연동할 수 있는 USDC와도 잠재적으로 사용될 수 있습니다.\n\n앞으로 이 기술을 더욱 탐구하고 발전시키면, 개인 결제, 금융 포용성, 탈중앙화 시스템에 대한 더욱 강력하고 견고한 응용 프로그램이 탄생할 수 있습니다.\n\n문의나 의견이 있으시면 LinkedIn에서 접할 수 있습니다: [마탄 프리드만 LinkedIn](https://www.linkedin.com/in/matan-friedman-898358249/)\n\nSemaphore 문서: [Semaphore docs](https://github.com/semaphore-protocol/semaphore)","ogImage":{"url":"/assets/img/2024-05-18-ADeepDiveintoSemaphore-PoweredPrivatePayments_0.png"},"coverImage":"/assets/img/2024-05-18-ADeepDiveintoSemaphore-PoweredPrivatePayments_0.png","tag":["Tech"],"readingTime":7},"content":"<!doctype html>\n<html lang=\"en\">\n<head>\n<meta charset=\"utf-8\">\n<meta content=\"width=device-width, initial-scale=1\" name=\"viewport\">\n</head>\n<body>\n<p><img src=\"/assets/img/2024-05-18-ADeepDiveintoSemaphore-PoweredPrivatePayments_0.png\" alt=\"Screenshot\"></p>\n<h2>Prerequisites:</h2>\n<p>To get the most out of this article, it's essential to have a good understanding of Semaphore. You can find the documentation <a href=\"https://docs.semaphore.pse.dev/\" rel=\"nofollow\" target=\"_blank\">here</a>.</p>\n<h1>Introduction</h1>\n<p>암호화폐 세계에서는 개인 정보 보호가 매우 중요합니다. 블록체인 기술은 투명성을 제공하지만 종종 민감한 금융 정보를 노출시킬 수 있습니다. 이에 Tornado Cash와 같은 해결책이 등장했는데, 이러한 해결책은 거래에서 익명성을 제공하려는 목표를 가지고 있습니다. 그러나 Tornado Cash는 남용 가능성으로 인해 조명을 받았습니다.</p>\n<p>여기에 강력한 프로토콜인 Semaphore이 등장했습니다. Semaphore은 거래 세부 정보를 숨기기 위해 제로-지식 증명 (ZKP)을 활용합니다. 이는 높은 수준의 제어와 사용자 정의 기능을 제공하여 개인 정보 보호 애플리케이션을 구축하는 데 이상적입니다.</p>\n<p>이 기사에서는 Semaphore의 새로운 응용 프로그램인 Paybox를 탐색할 것입니다. 이 분산 시스템은 자금을 안전하고 비공개적으로 관리하기 위해 Semaphore 프로토콜의 힘을 활용합니다.</p>\n<h2>Paybox</h2>\n<p>Paybox는 사용자가 자신의 기금을 예금할 수 있는 개인 “paybox”를 만들 수 있도록 합니다.</p>\n<p>다음은 작동 방식입니다:</p>\n<ul>\n<li>Paybox 생성: Paybox를 생성하여 상자의 “소유자”가 됩니다.</li>\n<li>자금 예금: 그 후 다른 사람들은 당신의 Paybox로 돈을 송금할 수 있습니다. 그들은 당신의 개인 정보를 알 필요가 없으며 Paybox ID만 필요합니다.</li>\n<li>자금 액세스: 소유자로서 원할 때마다 당신의 Paybox의 돈을 인출할 수 있습니다.</li>\n</ul>\n<p>이것을 디지턈 기부 상자처럼 생각해보세요:</p>\n<ul>\n<li>특정 페이박스로 돈을 보내는 방식으로 사람들은 목적에 기부할 수 있습니다.</li>\n<li>목적을 시작한 사람(페이박스 소유자)은 그 후에 rekte된 자금을 인출할 수 있습니다.</li>\n</ul>\n<p>페이박스는 가장 간단한 형태로 익명 및 안전하게 돈을 모으는 방법이며 전통적인 은행 계좌나 결제 처리기가 필요하지 않습니다.</p>\n<h2>페이박스를 위한 세마포어 사용법</h2>\n<p>세마포어 프로토콜은 제로-지식-증명(ZKP)을 페이박스 프로젝트에 도입하는 혁신적인 방법입니다. 세마포어는 우리의 주요 페이박스 계약 내에서 많은 머클 트리를 빠르고 쉽게 만들 수 있는 자원을 제공합니다. 각각의 머클 트리는 사용자가 예금하길 원하는 다른 금액에 대해 사용될 것입니다.</p>\n<h1>스마트 계약</h1>\n<p>우리는 생성자에서 이미 1~100까지의 그룹을 만들 것입니다. 이러한 그룹들은 자신의 paybox로 자금을 입금하는 과정에서 믹서로 사용될 것입니다. _createGroup 함수는 그룹 ID와 관리자를 입력받습니다. 믹서 그룹의 경우 누구도 관리자가 되면 안 되기 때문에 스마트 계약 자체가 그 역할을 수행할 것입니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-title function_\">constructor</span>(<span class=\"hljs-params\">ISemaphoreVerifier _verifier</span>) <span class=\"hljs-title class_\">Semaphore</span>(_verifier) {\n      <span class=\"hljs-keyword\">for</span> (uint i=<span class=\"hljs-number\">1</span>; i&#x3C;=<span class=\"hljs-number\">100</span>; i++) {\n          <span class=\"hljs-title function_\">_createGroup</span>(i, <span class=\"hljs-title function_\">address</span>(<span class=\"hljs-variable language_\">this</span>));\n      }\n  }\n</code></pre>\n<h2>상자 열기</h2>\n<p>상자를 열려면 상자 매핑에서 현재 그룹 ID와 함께 메시지 보내는 사람을 소유자로 설정합니다. 이 변수는 101부터 시작하여 새 상자마다 증가합니다.</p>\n<pre><code class=\"hljs language-js\">uint currentGroupId = <span class=\"hljs-number\">101</span>;    \n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createBox</span>(<span class=\"hljs-params\"></span>) public {\n      boxes[currentGroupId].<span class=\"hljs-property\">owner</span> = msg.<span class=\"hljs-property\">sender</span>;\n      currentGroupId++;\n  }\n</code></pre>\n<h2>입금</h2>\n<p>상자에 자금을 입금하려면 세마포어 ID를 생성해야 합니다. 이 ID에는 후에 증명을 생성하는 데 사용할 커밋먼트와 시크릿, 널리파이어가 포함됩니다. Identity를 생성하기 위해 Semaphore에는 매우 쉽게 사용할 수있는 JS 패키지가 있습니다.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">const</span> { <span class=\"hljs-title class_\">Identity</span> } = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"@semaphore-protocol/identity\"</span>)\n<span class=\"hljs-keyword\">const</span> identity = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Identity</span>()\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(identity)\n</code></pre>\n<p>이 신원 정보에는 후에 사용할 개인 키도 함께 포함되어 있습니다. 현재는 단순히 커밋먼트만 필요합니다.</p>\n<p>커밋먼트와 함께 자금을 예금할 때 사용자는 삽입할 금액을 입력해야 합니다. 이 금액은 사용자의 커밋먼트가 100개 그룹 중 어느 그룹에 배치될지 결정하는 데 사용됩니다.</p>\n<pre><code class=\"hljs language-javascript\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">deposit</span>(<span class=\"hljs-params\">uint amount, uint256 commitment</span>) public payable {\n    <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-number\">1</span> &#x3C;= amount &#x26;&#x26; amount &#x3C;= <span class=\"hljs-number\">100</span>, <span class=\"hljs-string\">\"Amount is not valid\"</span>);\n    <span class=\"hljs-built_in\">require</span>(amount &#x3C;= msg.<span class=\"hljs-property\">value</span> - <span class=\"hljs-number\">1</span>);\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">addMember</span>(amount, commitment);\n}\n</code></pre>\n<h2>상자에 자금 추가하기</h2>\n<p>이제 사용자가 특정 금액에 해당하는 그룹 내의 약속을 가지고 있으므로 addAmountToBox 함수를 호출할 수 있습니다. 이 호출은 유효한 증명만 있으면 어떤 지갑에서든 수행할 수 있습니다. 이 단계에서 사용자는 상자와 구분됩니다.</p>\n<p>사용자는 자신의 식별정보로 생성된 증명, 약속이 있는 그룹의 groupId(금액에 해당) 및 자금을 제공하려는 상자의 boxId와 함께 이 함수를 호출할 것입니다. 증명이 유효성 검사를 통과하면 nullifierHash가 그룹에 저장되고 groupId(금액)이 boxId의 boxFund에 추가됩니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addAmountToBox</span>(<span class=\"hljs-params\">SemaphoreProof calldata proof, uint groupId, uint boxId</span>)public {\n    <span class=\"hljs-built_in\">require</span>(scope == proof.<span class=\"hljs-property\">scope</span>, <span class=\"hljs-string\">\"유효 범위가 맞지 않음\"</span>);\n    <span class=\"hljs-keyword\">if</span> (groups[groupId].<span class=\"hljs-property\">nullifiers</span>[proof.<span class=\"hljs-property\">nullifier</span>]) {\n        revert <span class=\"hljs-title class_\">Semaphore</span>__YouAreUsingTheSameNullifierTwice();\n    }\n    <span class=\"hljs-comment\">// 증명이 성공적으로 검증되지 않으면 함수가 되돌아갑니다.</span>\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-title function_\">verifyProof</span>(groupId, proof)) {\n        revert <span class=\"hljs-title class_\">Semaphore</span>__InvalidProof();\n    }\n    groups[groupId].<span class=\"hljs-property\">nullifiers</span>[proof.<span class=\"hljs-property\">nullifier</span>] = <span class=\"hljs-literal\">true</span>;\n    boxes[boxId].<span class=\"hljs-property\">boxFund</span> += groupId;\n}\n</code></pre>\n<p>프로프를 생성하고 인출 함수를 호출하려면 Semaphore 패키지를 사용할 수 있습니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">const</span> {<span class=\"hljs-title class_\">SemaphoreEthers</span>} = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">\"@semaphore-protocol/data\"</span>)\n<span class=\"hljs-keyword\">const</span> { <span class=\"hljs-title class_\">Group</span> } =<span class=\"hljs-built_in\">require</span> (<span class=\"hljs-string\">\"@semaphore-protocol/group\"</span>)\n<span class=\"hljs-keyword\">const</span> { generateProof, verifyProof} =<span class=\"hljs-built_in\">require</span> (<span class=\"hljs-string\">\"@semaphore-protocol/proof\"</span>)\n\n<span class=\"hljs-keyword\">const</span> semaphoreEthers = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SemaphoreEthers</span>(<span class=\"hljs-string\">\"http://3.22.38.202:8545\"</span>, {\n    <span class=\"hljs-attr\">address</span>: <span class=\"hljs-string\">\"0xf7C339C5520f6800266227878A6A44Db4eEc35C4\"</span>\n})\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">main</span>(<span class=\"hljs-params\"></span>){\n  <span class=\"hljs-keyword\">const</span> payboxContract = <span class=\"hljs-keyword\">new</span> ethers.<span class=\"hljs-title class_\">Contract</span>(<span class=\"hljs-string\">\"0xf7C339C5520f6800266227878A6A44Db4eEc35C4\"</span>, payboxTCAbi, wallet)\n  <span class=\"hljs-keyword\">const</span> identity = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Identity</span>(<span class=\"hljs-string\">\"e6d8b796a4d35d6b7c3461048ec2e7a0f9d48a61d9d19063f95bcbf384d21330\"</span>)\n  <span class=\"hljs-keyword\">const</span> members = <span class=\"hljs-keyword\">await</span> semaphoreEthers.<span class=\"hljs-title function_\">getGroupMembers</span>(<span class=\"hljs-string\">\"75\"</span>)\n  <span class=\"hljs-keyword\">const</span> group = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Group</span>(members)\n  <span class=\"hljs-keyword\">const</span> proof = <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">generateProof</span>(identity, group, <span class=\"hljs-number\">0</span>, publicNullifier)\n  <span class=\"hljs-keyword\">const</span> tx = <span class=\"hljs-keyword\">await</span> payboxContract.<span class=\"hljs-title function_\">addAmountToBox</span>(proof, <span class=\"hljs-number\">75</span>, <span class=\"hljs-number\">102</span>)\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">\"자금을 인출 중입니다...\"</span>)\n  <span class=\"hljs-keyword\">await</span> tx.<span class=\"hljs-title function_\">wait</span>()\n}\n</code></pre>\n<h2>출금</h2>\n<p>출금 함수는 매우 간단합니다. 상자 ID 소유자에 해당하는 지갑은 출금하려는 금액과 함께 함수를 호출해야 합니다. 이 금액은 그런 다음 계약으로부터 지갑으로 이체되며 상자 자금은 재설정됩니다.</p>\n<pre><code class=\"hljs language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">withdraw</span>(<span class=\"hljs-params\">uint boxId, uint amountToWithdraw</span>)public{\n    <span class=\"hljs-built_in\">require</span>(boxes[boxId].<span class=\"hljs-property\">owner</span> == msg.<span class=\"hljs-property\">sender</span>, <span class=\"hljs-string\">\"ur not the owner of the box\"</span>);\n    uint amount;\n    <span class=\"hljs-keyword\">if</span>(amountToWithdraw > boxes[boxId].<span class=\"hljs-property\">boxFund</span>){    <span class=\"hljs-comment\">// if amount req is bigger than fund give everything in box</span>\n        <span class=\"hljs-title function_\">payable</span>(msg.<span class=\"hljs-property\">sender</span>).<span class=\"hljs-title function_\">transfer</span>(boxes[boxId].<span class=\"hljs-property\">boxFund</span>);\n        boxes[boxId].<span class=\"hljs-property\">boxFund</span> = <span class=\"hljs-number\">0</span>;\n    }\n    <span class=\"hljs-keyword\">else</span>{   <span class=\"hljs-comment\">// if amount is smaller than fund give amount</span>\n        <span class=\"hljs-title function_\">payable</span>(msg.<span class=\"hljs-property\">sender</span>).<span class=\"hljs-title function_\">transfer</span>(amount);\n        boxes[boxId].<span class=\"hljs-property\">boxFund</span> -= amount;\n    }\n}\n</code></pre>\n<h1>결론</h1>\n<p>세마포어 프로토콜을 기반으로 한 Paybox 시스템은 암호화폐 분야에서 더 안전하고 비공개적인 거래를 위한 중요한 발전을 나타냅니다. 토네이도 캐시의 익명성 원칙을 Semaphore의 향상된 제어 및 사용자 정의 기능과 결합하여 자금을 관리하기 위한 독특하고 강력한 시스템을 만들었습니다.</p>\n<p>주요 포인트:</p>\n<ul>\n<li>Paybox은 결제 시 개인 정보 보호와 보안을 위해 Semaphore 프로토콜을 활용하고 있습니다.</li>\n<li>개별 Paybox를 나타내기 위해 Semaphore 그룹을 사용합니다.</li>\n<li>사용자는 익명으로 자금을 입금할 수 있으며, Paybox 관리자는 언제든지 인출할 수 있습니다.</li>\n<li>이 시스템은 강화된 개인 정보 보호와 안전을 제공하면서 자금을 유연하고 강력하게 관리할 수 있는 방법을 제시합니다.</li>\n<li>Paybox 계약은 암호화폐나 ERC20과 함께 사용되며, 달러와 연동할 수 있는 USDC와도 잠재적으로 사용될 수 있습니다.</li>\n</ul>\n<p>앞으로 이 기술을 더욱 탐구하고 발전시키면, 개인 결제, 금융 포용성, 탈중앙화 시스템에 대한 더욱 강력하고 견고한 응용 프로그램이 탄생할 수 있습니다.</p>\n<p>문의나 의견이 있으시면 LinkedIn에서 접할 수 있습니다: <a href=\"https://www.linkedin.com/in/matan-friedman-898358249/\" rel=\"nofollow\" target=\"_blank\">마탄 프리드만 LinkedIn</a></p>\n<p>Semaphore 문서: <a href=\"https://github.com/semaphore-protocol/semaphore\" rel=\"nofollow\" target=\"_blank\">Semaphore docs</a></p>\n</body>\n</html>\n"},"__N_SSG":true}